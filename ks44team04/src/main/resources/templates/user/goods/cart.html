<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/userDefault}">
<th:block layout:fragment="customContents">
<!-- 장바구니 상품 삭제 아이콘 -->
<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-bold-rounded/css/uicons-bold-rounded.css'>
<style>
* { font-family: 'Spoqa Han Sans Neo', 'sans-serif'; color: #333;}
/* 전체 선택 checkbox css */
.allCheck { position: relative; top: 1.5px; width: 18px; height: 18px;  border: 1px solid #d3d3d3; border-radius: 50%; appearance: none; cursor: pointer; transition: background 0.2s; }
.allCheck:checked { background: #b3d97a; border: 1px solid #a1da4c; }

/* plus minus 버튼 */
.plusMinusBtn { width:35px; height:35px; border:1px; border-radius: 50%; background-color:#f1f1f1;
		   	    font-size: 25px; font-weight:bold; line-height: 20px; }
button:focus{ outline:none; border:none; }

</style>

<section class="ftco-section" style="padding:2em 0;">
	<div class="container">
		<div class="row justify-content-center">
			<div class="text-center">
				<div style="font-size:25px; margin-bottom:15px;">장바구니</div>
            </div>
        </div>
        
		<div class="row">
			<div class="col-md-8 ftco-animate">
				<div style="font-size:17px; margin-bottom:-10px;">
					<input type="checkbox" class="allCheck" style="margin-right:5px;">전체선택
						<span style="color:gray;">&nbsp;&nbsp;|</span>
						<button class="selectDel" style="border:none; background-color:rgba(0,0,0,0); outline: none; cursor:pointer;">선택삭제</button>
				</div>
			<hr>
				<div class="form-inline" style="width:100%;">
					<input type="checkbox" class="allCheck" style="margin-right:15px;">
						<img src="/images/goodsTest/apple.png" style="width:85px; height:85px; border-radius:5px;">
						<span style="width:280px; font-size:18px; font-weight: 500; line-height:22px; color:#333; margin-left: 10px; vertical-align:middle;">맛있는 사과 2kg</span>
					<div class="form-inline">
						<div class="plusMiusDiv input-group" style="width: 150px;">
							<button type="button" class="plusMinusBtn minusBtn">-</button>&nbsp;
							<input type="text" class="countVal form-control" value="1" min="1" max="30" style="size:10px; height:35px !important; text-align:center; border-color:#f1f1f1;">&nbsp;
							<input type="hidden" class="goodsStock" th:value="*{goodsStock}">
							<button type="button" class="plusMinusBtn plusBtn">+</button>
						</div>
						<span style="position:releative; font-weight:700; font-size:18px; width:120px; text-align:right;">14,000원</span>
							<span style="position:absolute; right:58px; top:107px; font-size:14px; color:#767676; text-decoration: line-through;">16,000원</span>
						<i class="fi fi-br-cross" style="font-size:17px; color:#d3d3d3; width:35px; text-align:right; margin-top:3px;"></i>
					</div>
				</div>
				<hr style="border-style: dashed;">
			
			
			</div>
		
			<div class="col-md-4 ftco-animate" style="margin-top:38px; padding-right:65px;">
				<div style="border:1px solid #e5e5e5; width:100%; height:235px;">
					<div style="padding:25px 35px 25px 35px;">
						<div>
							<span style="font-size:17px; margin-right:60px;">상품금액</span>
							<span style="font-size:17px; float:right;">16,000원</span>
						</div>
						<div>
							<span style="font-size:17px; margin-right:60px;">할인금액</span>
							<span style="font-size:17px; float:right;">-1,600원</span>
						</div>
						<div>
							<span style="font-size:17px; margin-right:60px;">배송비</span>
							<span style="font-size:17px; float:right;">+3,000원</span>
						</div>
						<hr>
						<div>
							<span style="font-size:17px; margin-right:60px;">주문금액</span>
							<span style="font-size:17px; float:right;">17,400원</span>
						</div>
						<div style="float:right; margin-top:5px;">
							<span class="badge" style="background-color:#d1ebab;">적립</span>
							<span style="font-size:13px; vertical-align:text-top;">72원 적립</span>
							<span style="font-size:11px; color:#939393;">씨앗등급 0.5%</span>
						</div>
					</div>
				</div>
				<div style="padding-top:10px;">
					<button style="width:100%; height:70px; border:none; background-color:#d1ebab; font-size:20px; font-weight:500;">주문하기</button>
				</div>
			</div>
		</div>
	</div>
	<hr style="width: 80%; text-align:left; margin: auto; margin-top:50px; margin-bottom:50px;">
	
</section>


</th:block>
<th:block layout:fragment="customJsScript">
<th:block th:replace="/fragments/userJs :: datatablesFragment"></th:block>
<script th:inline="javascript">

$(function() {
	
		//상품 가격
	var goodsPrice = $('.goodsPrice').val();
		//상품 할인율
	var goodsDiscountRate = $('.goodsDiscountRate').val();
		//상품 할인가
	var discounted = goodsPrice * goodsDiscountRate / 100;
		//상품 정가-할인가 = 할인가격
	var salePrice = goodsPrice - discounted;
		//할인가격 * 선택 수량
	var totalPrice = salePrice * countVal
	
	/* 수량 증가 감소 */
	//var goodsStock = $('.goodsStock').val(); //실제 상품 재고량 가져오기
	var goodsStock = 15;
	var strNum = $('.countVal').val(); //val에 들어있는 값은 아직 문자
	var countVal = parseInt(strNum, 10); //문자를 숫자로 
	// 감소버튼
	$('.minusBtn').click(function(e){
		e.preventDefault();
		countVal--;
		
		if(countVal <= 0){
			alert('최소 수량입니다');
			countVal = 1;
		}
		$('.countVal').val(countVal);
		console.log('minus 버튼: '+countVal);
		
		//수량 변경값에 따라 총 금액 변화주기
		$('.hiddenPrice').val(salePrice * countVal);
		var hiddenPrice = $('.hiddenPrice').val().replace(/(\d)(?=(?:\d{3})+(?!\d))/g,'$1,');
		$('.totalPrice').text(hiddenPrice);
		console.log(hiddenPrice);
	});
	// 증가 버튼
	$('.plusBtn').click(function(e){
		e.preventDefault();
		countVal++;
		
		if(countVal > goodsStock){
			alert('최대 수량입니다');
			countVal = goodsStock;
		}
		$('.countVal').val(countVal);
		console.log('plus 버튼: '+countVal);
		
		//수량 변경값에 따라 총 금액 변화주기
		$('.hiddenPrice').val(salePrice * countVal);
		var hiddenPrice = $('.hiddenPrice').val().replace(/(\d)(?=(?:\d{3})+(?!\d))/g,'$1,');
		$('.totalPrice').text(hiddenPrice);
		console.log(hiddenPrice);
	});

    
});
</script>
</th:block>
</html>