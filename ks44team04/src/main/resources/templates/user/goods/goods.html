<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/userDefault}">
      
<th:block layout:fragment="customCss">
<!-- 폰트 -->
<link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css' rel='stylesheet' type='text/css'>
<!-- 이미지 내 화살표 아이콘 -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" rel="stylesheet" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
<!-- 별, 장바구니, 찜하기, 자물쇠 아이콘 -->
<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css'>
<!-- 초희 하트 이미지  -->
<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-solid-rounded/css/uicons-solid-rounded.css'>
<!-- 초희 댓글 이미지  -->
<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css'>
<!-- 문의, 답변, 답변대기 아이콘 -->
<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-bold-straight/css/uicons-bold-straight.css'>
<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-bold-rounded/css/uicons-bold-rounded.css'>

<style>
* { font-family: 'Spoqa Han Sans Neo', 'sans-serif'; color: #333;}

/* plus minus 버튼 */
.plusMinusBtn { width:40px; height:40px; border:1px; border-radius: 50%; background-color:#f1f1f1;
		   	    font-size: 25px; font-weight:bold; line-height: 20px; }
button:focus{ outline:none; border:none; }

/* 구매하기 버튼 스타일 적용  */
.buyBtn { background-color:#b3d97a; border-radius:28px; border:1px solid #ffffff;
		  display:inline-block; cursor:pointer; color:#ffffff; font-size:18px; padding:10px 60px; }
.buyBtn:hover { background-color:#a5cf67; color:#ffffff; }

/* 장바구니&관심상품 버튼 스타일 적용  */
.cartBtn { background-color:#dbe6c4; border-radius:28px; border:1px solid #ffffff;
		   display:inline-block; cursor:pointer; color:#333; font-size:17px; padding:10px 27px; }
.cartBtn:hover { background-color:#ceddae; color:#636363; }

/* 상품 상세 이미지 */
.img { position: absolute; top:0; left:0; width:100%; height:500px;
       -webkit-transition: opacity 1s ease-in-out; -moz-transition: opacity 1s ease-in-out;
	   -o-transition: opacity 1s ease-in-out; transition: opacity 1s ease-in-out;
       opacity: 0; -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"; filter: alpha(opacity=0); }
.img:first-child { opacity: 1; }

/* 이미지 슬라이드 왼쪽&오른쪽 버튼 */
.imgBtn { display: inline-block; font-weight: 400; text-align: center; vertical-align: middle;
          user-select: none; border: 1px solid transparent; padding: 0.375rem 0.75rem; font-size: 1rem;
          line-height: 1.5; border-radius: 30px; color: #f6f6f6; opacity: 60%; background-color:transparent; }
.imgLeftBtn:focus, .imgRightBtn:focus{ outline:none; }

/* 이미지 슬라이드 밑에 배너 */
.imgSlideList ul li { list-style-type: none; display: inline; }
.imgSlideList ul { text-align: center; margin: 0; padding: 0;}
.imgSlideList li { display: inline-block; }
.imgSlideList li img { width: 50px; height: 50px; }

/* 상품 정보&후기&문의 탭 */
.goodsTabCon .goodsTab { width: 1024px; margin: 0px auto; background-color: #fff; }
.goodsTab .goodsTab .tabList::after { content: ''; display: block; clear: both; }
.goodsTab ul, .goodsTab li { padding:0px; margin:0px; }
.goodsTab li { float: left; display: block; width: 33%; height: 40x; line-height: 40px; background: #f7f7f7; border: 1px solid #dddddd;
			   padding: 0; color: #333; text-align: center; font-size: 16px; font-weight: 400; text-decoration: none; }
.goodsTab li.current { border-bottom: 0; }
.goodsTab li.current, .goodsTab li:hover { background: 0; }

/* 탭 content 디자인 */
.tabContent { margin-top: 20px; display: none; padding: 0px 20px 0px 20px; height: 100%; }
.tabContent.current { display: inherit; }

/* 문의 탭 테이블 */
.qnaTable thead th { height: 45px; text-align: center; font-weight: normal; font-size: 15px; color: #111; border-bottom: 1px solid #ddd; background: #fafafa;}
.qnaTable tbody td { font-size: 15px; color: #666; line-height: 15px; padding: 15px 0; border-bottom: 1px solid #e6e6e6; text-align: center; }
.qnaModalBtn { position: absolute; right: 0px; padding: 0px 10px; text-align: center; width: 110px; height: 40px;
			   font-size: 15px; background-color: #dbe6c4; border:none; border-radius:28px; }
			   
/* 문의하기 모달 스타일 */
.modal { text-align: center; padding: 0!important; }
.modal:before { content: ''; display: inline-block; height: 100%; vertical-align: middle; margin-right: -4px; }
.modal-dialog { display: inline-block; text-align: left; vertical-align: middle; }
.qnaSelect { width: 100px; border: 1px solid #d3d3d3; border-radius: 3px; outline: none; padding: 5px; }
.qnaInContent { width: 500px; height:150px; border: 1px solid #d3d3d3; overflow-y:auto; resize: none; border-radius: 3px; outline: none;}
.secretYN { position: relative; top: 1.5px; width: 1rem; height: 1rem;  border: 1px solid #d3d3d3; border-radius: 50%; appearance: none; cursor: pointer; transition: background 0.2s; }
.secretYN:checked { background: #b3d97a; border: none; }
.qnaSubmit { cursor:pointer; background-color:#dbe6c4; border-radius: 15px; height: 30px; width: 70px; border:none; }
.qnaClose { cursor:pointer; background-color:#e5e5e5; border-radius: 15px; height: 30px; width: 70px; border:none; }
.qnaPw { border: 1px solid #d3d3d3; border-radius: 3px; width: 100px; vertical-align: middle; outline: none; height: 25px; }

/* 초희 모달  */
.starModal fieldset{
    display: inline-block;
    direction: rtl;
    border:0;
}
.starModal fieldset legend{
    text-align: right;
}
.starModal input[type=radio]{
    display: none;
}
.starModal label{
    font-size: 3em;
    color: transparent;
    text-shadow: 0 0 0 #f0f0f0;
}
.starModal label:hover{
    text-shadow: 0 0 0 rgba(250, 208, 0, 0.99);
}
.starModal label:hover ~ label{
    text-shadow: 0 0 0 rgba(250, 208, 0, 0.99);
}
.starModal input[type=radio]:checked ~ label{
    text-shadow: 0 0 0 rgba(250, 208, 0, 0.99);
}
#reviewContents {
    width: 100%;
    height: 150px;
    padding: 10px;
    box-sizing: border-box;
    border: solid 1.5px #D3D3D3;
    border-radius: 5px;
    font-size: 16px;
    resize: none;
}

/* 초희 하트 */
.off span i{
	display: inline-block; /* 하위 별점 이미지들이 있는 영역만 자리를 차지함.*/
    border: 0; /* 필드셋 테두리 제거 */
    color: transparent; /* 기존 이모지 컬러 제거 */
    text-shadow: 0 0 0 #f0f0f0; /* 새 이모지 색상 부여 */
 
}
.on span i{
	display: inline-block; /* 하위 별점 이미지들이 있는 영역만 자리를 차지함.*/
    border: 0; /* 필드셋 테두리 제거 */
    color: transparent; /* 기존 이모지 컬러 제거 */
    text-shadow: 0 0 0 #f00; /* 새 이모지 색상 부여 */
}

.divMom div:not(.container):not(.goodsTab) { margin: 5px 0px }

</style>
	
	
</th:block>

<th:block layout:fragment="customContents">
<section class="divMom ftco-section" style="padding:4em 0;">

<div class="container" style="display: block; position: relative;">
	<div class="row" th:object="${goodsInfo}">
        
		<div class="col-lg-6 mb-5">
            <div class="imgBtnWrap" style="position: relative; z-index:1; width: 100%; height: 500px; margin: auto;">
				<div class="imgBtnDiv" style="position: absolute; z-index:2; top: 40%; margin: auto;">
					<button type="button" class="imgLeftBtn imgBtn"><i class="fa fa-chevron-left fa-4x" style="color:#f7f7f7;"></i></button>
					<button type="button" class="imgRightBtn imgBtn" style="margin-left: 389px;"><i class="fa fa-chevron-right fa-4x" style="color:#f7f7f7;"></i></button>
				</div>
				<div class="imgBox" style="width:100%; height:500px;">
					<!-- <div th:each="l : ${goodsInfo}" th:text="${l.fileInfo.filePath}"> 
					</div>-->
					<th:block th:if="${not #lists.isEmpty(goodsInfo.fileList)}" th:each="fl : ${goodsInfo.fileList}">					
			            <img class="img-fluid img on" th:src="@{'/' + ${fl.filePath}}" th:alt="*{goodsName}">
					</th:block>
					<!-- <img class="img-fluid img" src="/images/goodsTest/gom.png" th:alt="*{goodsName}">
					<img class="img-fluid img" src="/images/goodsTest/gom2.png" th:alt="*{goodsName}">
					<img class="img-fluid img" src="/images/goodsTest/gom3.png" th:alt="*{goodsName}">
					<img class="img-fluid img" src="/images/goodsTest/gom4.png" th:alt="*{goodsName}"> -->
				</div>
				<div class="imgSlideList">
					<ul class="imgSlide">
						<li th:if="${not #lists.isEmpty(goodsInfo.fileList)}" th:each="fl : ${goodsInfo.fileList}">
							<img th:src="@{'/' + ${fl.filePath}}" th:alt="*{goodsName}">
						</li>
		            </ul>
                </div>
			</div>
		</div>

		<div class="col-lg-6 mb-5">
			<div style="margin: auto;">
				<span style="font-weight:500; font-size:28px;" th:text="*{goodsName}"></span>
				<div style="margin-bottom: -20px; margin-left : 10px; text-decoration: line-through; color:#767676" th:text="*{#numbers.formatInteger(goodsPrice,3,'COMMA')+'원'}"></div>
					<input type="hidden" class="goodsPrice" th:value="*{goodsPrice}">
				<div class="container">
					<div class="row">
		            	<div class="col">
							<span style="font-weight: 700; font-size: 20px; color: #84B147;" th:text="*{goodsDiscountRate + '%'}"></span>
							<input type="hidden" class="goodsDiscountRate" th:value="*{goodsDiscountRate}">
							<span style="font-weight: 700; font-size: 23px; margin-left: 5px;" th:text="*{#numbers.formatInteger((goodsPrice-goodsPrice*goodsDiscountRate/100),3,'COMMA') + '원'}"></span>
						</div>
						<div class="col">
							<p style="margin:0 auto; margin-top:9px; float:right;">
								<a href="#"><i class="fi fi-rr-star" style="color:#8eae46;"></i></a>
								<a href="#"><i class="fi fi-rr-star" style="color:#8eae46;"></i></a>
								<a href="#"><i class="fi fi-rr-star" style="color:#8eae46;"></i></a>
								<a href="#"><i class="fi fi-rr-star" style="color:#8eae46;"></i></a>
								<a href="#"><i class="fi fi-rr-star" style="color:#8eae46;"></i></a>
								<span style="font-size:16px; font-weight: 300; vertical-align:bottom; color:#8eae46;">5.0</span>
							</p>
						</div>
					</div>
				</div>
				<hr style="margin-top: -5px; margin-left : 0; width: 98%;">
				<div style="width:95%; margin:auto;">
					<div>
						<p th:text="*{goodsContent}"></p>
					</div>
					<div class="d-flex flex-column mb-3">
						<div class="p-1 font-family"><span>배송비</span></div>
						<div class="p-1 font-family"><span>묶음배송</span></div>
						<div class="p-1 font-family"><span>정기배송</span></div>
					</div>
					<div class="col-md-12" style="margin-left:-10px;">
						<div class="plusMiusDiv input-group" style="width: 150px;">
							<button type="button" class="plusMinusBtn minusBtn">-</button>&nbsp
							<input type="text" class="countVal form-control" value="1" min="1" max="30" style="height:40px !important; text-align:center; border-color:#f1f1f1;">&nbsp
							<input type="hidden" class="goodsStock" th:value="*{goodsStock}">
							<button type="button" class="plusMinusBtn plusBtn">+</button>
						</div>
					</div>
				</div><br>
				<hr style="margin-top: -5px; margin-left : 0; width: 98%;">
				<div class="form-group" style="font-size:18px; width:70%; margin:auto; text-align:right;">
					<span>총 상품금액</span>
					<span style="font-weight:bold; color:#84B147; margin-left: 100px;" class="totalPrice" th:text="*{#numbers.formatInteger((goodsPrice-goodsPrice*goodsDiscountRate/100),3,'COMMA')}"></span>
					<input type="hidden" class="hiddenPrice">
					<span style="color:#84B147;">원</span>
				</div>
				<div class="form-group">	
					<a href="#" class="buyBtn" style="margin-left:30px;">구매하기</a>
					<a href="#" class="cartAddBtn cartBtn"><i class="fi fi-rr-shopping-cart" style="vertical-align:-2px"></i>&nbsp;장바구니 </a>
					<input type="hidden" class="goodsCode" th:value="*{goodsCode}">
					<a href="#" class="wishAddBtn cartBtn"><i class="fi fi-rr-search-heart" style="vertical-align:-2px"></i>&nbsp;찜하기 </a>
				</div>
			</div>
		</div>
	</div>
</div>
<hr style="width: 80%; text-align:left; margin: auto;">

<div class="goodsTabCon" id="goodsTabCon">
	<div style="width:1024px; height:50px; margin:auto;"></div>
	<div class="goodsTab" id="goodsTab">
	
		<div class="goodsTab" id="goodsTab">
			<ul class="tabList" style="list-style:none; vertical-align: top;">
				<li class="tabLink current" data-tab="tab-1">상품정보</li>
				<li class="tabLink" data-tab="tab-2">후기</li>
				<li id="qnaTab" class="tabLink" data-tab="tab-3">문의</li>
			</ul>
			<div class="clear"></div>
	
			<div class="tabDetail">
			
			
			
			
			
				<!-- 상품 정보 Content 시작 -->
				<div id="tab-1" class="tabContent current" th:object="${goodsInfo}">
					<p th:text="*{goodsDetail}"></p>
				</div>
				<!-- 상품 정보 Content 끝 -->
				
				
				
				
				
				<!-- 상품 후기 Content 시작 -->
				<div id="tab-2" class="tabContent" th:object="${goodsInfo}">
					<div>
	  					<div style="text-align: center; font-size: 20px;"><b>사용자 총평</b></div>
	  					<div style="text-align: center; font-size: 50px;" > ★★★★★ </div>
	  					<hr style="border: solid 1px black;">
	  					<b style="font-size: 18px; margin-left:50px; " > 포토 </b>
	  					<hr style="border: solid 1px black;">
	  				<div class="row">
		  				<div class="col-9" >
		  					<b style="font-size: 18px; margin-left:50px;" > 후기 </b>
		  				</div>
						<div class="col-3"  style="text-align: left;"> 
					  		<select>
					  			<option>최신순</option>
					  			<option>평점 낮은 순</option>
					  			<option>평점 높은 순</option>
					  			<option>추천수 높은 순</option>
					  			<option>추천수 낮은 순</option>
					  		</select>
					  		<label>
								<button type="button" class="btn btn-primary" data-toggle="modal"
									data-target=".review" id="reviewModal" data-backdrop="static" style="font-size: 15px; background-color: #B3D97A; outline: none; border-color: #B3D97A ">후기작성</button>
							</label>
						</div>	  		
	  				</div>
	  				<th:block th:if="${not #lists.isEmpty(reviewSpecific)}" th:each="l : ${reviewSpecific}">
			    		  <div class="row " style="margin-left: 80px; margin-top: 35px;">
			       			 <div  class="col-12">
			        			<span>
			        				<th:block th:each="gradeLoop : ${#numbers.sequence(1, l.grade)}">★</th:block>
			        			</span>
			          			<input type="hidden"  th:value="${l.grade}">
			          			
			       			 </div>
			       			 
			          			
			        		 <div class="col-12" >
			        			<span>
			        				<label th:text="${l.buyerId} + '○' + ${l.reviewRegDate}"></label>
			        			</span>
								<button th:if="${session.SID} == ${l.buyerId}" type="button" class="btn" style="font-size: 13px; padding: 0px;">수정</button>        
					         	<button th:if="${session.SID} == ${l.buyerId}" type="button" class="btn"  style="font-size: 13px; padding: 0px;">삭제</button>		      
			       			 </div>
			       			 <div class="col-8">
			        			<p th:text="${l.reviewContent}"></p>
			        		 </div>
							 <div class="col-4" >
								<label>
									<button type="button" class="reviewLikeBtn off" style="border: none; background-color: white; outline: none;" th:value="${l.reviewList}">
										 <span><i class="fi fi-sr-heart"></i></span>
								 	</button>
									<span  th:text="'추천수 ' + ${l.likeAmount}  "></span>
								 </label>
								 <label>
									  <button type="button" class="btn btn-link  reviweCommentCode" style="color: black;" data-toggle="modal" data-target=".reviweComment"  th:data-review-code="${l.reviewList}" data-backdrop="static"> <i class="fi fi-rr-comment" ></i> 댓글</button>
								 </label>
								 <label>
									 <button type="button" style="color: black;" class="btn btn-link userReportModal" data-toggle="modal" data-target=".userReport" id="userReportModal" th:data-review-list="${l.reviewList}" th:data-buyer-id="${l.buyerId}" data-backdrop="static">신고</button>
								 </label>
			       			 		
							</div>
					
							<input type="hidden" id="userId" name="userId" value="buyer01">
							<input type="hidden" id="reviewList" name="reviewList" value="review001">
					
			    		  </div>
					      <div class="row">
						  	<hr align="center" style="border: solid 1px black; width: 82%;">
					      </div>
			      </th:block>
				</div>	
			</div>	
				
				</div>
				<!-- 상품 후기 Content 끝 -->
				
				
				
				
				
				
				<!-- 상품 문의 Content 시작 -->
				<div id="tab-3" class="tabContent">
					<div id="qnaList">
							<div style="font-size: 22px; color: #333; height: 30px; text-align: left; font-weight: 500;">상품문의</div>
						<div style="border: 1px solid #dcdcdc; background-color: #f8f8f8; margin-top: 15px;">
							<div style="padding: 10px 15px; color: #666; line-height: 1.5; font-size: 14px; font-weight: 400;">
								- 배송관련, 주문(취소/교환/환불)관련 문의 밑 요청사항은 <span style="font-weight:500;">고객센터 내 1:1 문의하기</span>를 이용해주세요.<br>
								- 해당 상품 자체와 관계없는 글, 양도, 광고성, 욕설, 비방, 도배 등의 글은 예고없이 노출제한, 삭제 등의 조치가 취해질 수 있습니다.
							</div>
						</div>
						<table class="qnaTable" style="width: 100%; table-layout: fixed; border-top: 1px solid #bbb; margin-top: 10px;">
							<colgroup><col width="100"><col width="100"><col width="*"><col width="100"><col width="125"></colgroup>
							<thead style="vertical-align: middle;">
								<tr>
									<th>문의유형</th><th>답변상태</th><th>제목</th><th>문의자</th><th>등록일</th>
								</tr>
							</thead>
							<tbody id="qnaList" style="vertical-align: middle;">
							<th:block th:if="${not #lists.isEmpty(goodsQnaInfo)}" th:each="gqi : ${goodsQnaInfo}">
								<tr th:data-secret="${gqi.secretCheck}">
									<td th:text="${gqi.goodsQnaCategoryInfo.categoryName}"></td>
									<td th:text="${'['+gqi.qnaStatus+']'}" class="answerYN" th:classappend="(${gqi.qnaStatus}=='완료'?Y:'')+(${gqi.qnaStatus}=='대기'?N:'')"></td>
									<td th:text="${gqi.goodsQnaTitle}" class="qnaToggle" style="cursor:pointer;"></td>
									<td th:text="${gqi.userInfo.userId}"></td>
									<td th:text="${#strings.substring(gqi.regDate,0,10)}"></td>
								</tr>
						 		<tr class="answerToggle" style="display:none;">
						 			<td colspan="2"></td>
						 			<td colspan="2" style="text-align:left; padding-left:50px; background-color:#f4f8ed;">
						 			<div>
							 			<div style="display:table-cell;">
							 				<i class="fi fi-bs-comment-question" style="font-size:20px; color:#98b856;"></i>
							 				<span th:text="${gqi.goodsQnaContent}" style="padding-left:10px; vertical-align:text-top; font-size:16px;"></span>
							 			</div>
						 			</div>
						 			<div style="margin-top:20px;">
							 			<div th:if="${gqi.qnaStatus}=='답변완료'" style="display:table-cell;" >
							 				<i class="fi fi-br-comment-check" style="font-size:20px; color:#98b856;"></i>
							 				<span th:text="${gqi.goodsAnswerInfo.goodsAnswerContent}" style="padding-left:10px; vertical-align:text-top; font-size:16px;"></span>
							 			</div>
							 			<div th:unless="${gqi.qnaStatus} == '답변완료'" style="display:table-cell;">
							 			</div>
							 			<div>
							 			
							 				<span th:text="${#strings.substring(gqi.goodsAnswerInfo.regDate,0,10)}" style="float:right; padding-right:20px;"></span>
						 				</div>
						 			</div>
						 			</td> 
						 		</tr>
								<tr th:unless="${not #lists.isEmpty(goodsQnaInfo)}">
								<td colspan="5">등록된 문의가 없습니다.</td>
								</tr>
							</th:block>
							</tbody>
						</table>
					</div>
					<div style="position: relative; width: 100%; height: 40px; display: flex; margin-top:10px;">
						<div>
							<button type="button" class="qnaModalBtn Modal" data-toggle="modal" data-target="#qnaModal">문의하기</button>
						</div>
					</div>
					<!-- 상품 문의 Content 끝 -->
					
					
					
					
				</div>
			</div>
		</div>
	</div>
</section>

		
<!-- 상품 문의 모달 실행 -->
<form id="qnaModalForm" name="qnaModalForm" th:action="@{/user/goods/goods}" method="post">
	<div class="qnaModal modal fade" id="qnaModal" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-lg" role="document" style="width:700px; height:500px;">
	    <div class="modal-content" style="height:100%;">
	      <div class="modal-header" style="margin-top: -5px;">
	        <div class="modal-title" id="qnaModalLabel" style="font-weight: 400; color:#333; font-size:23px; ">상품 문의하기</div>
	      </div>
	      <div class="modal-body">
	          <div class="form-group" style="margin: -10px 0px 0px 10px;" >
	            <img th:src="@{'/' + ${goodsInfo.fileList[0].filePath}}" style="width:70px; height:70px; border-radius:5px;">
	            <span th:text="${goodsInfo.goodsName}" style="font-size:16px; font-weight: 500; line-height:22px; color:#333; margin-left: 10px; vertical-align:middle;"></span>
	          </div>
	          	<hr>
	          <div class="form-group" style="margin-left:10px;">
	          	<span style="margin-right:10px;">문의유형</span>
	          	<select class="qnaSelect" id="goodsQnaCategory" name="goodsQnaCategory">
	          		<option value="none">:::</option>
	          		<th:block th:unless="${#lists.isEmpty(goodsQnaCategoryList)}" th:each="gqcl : ${goodsQnaCategoryList}">
						<option th:text="${gqcl.categoryName}" th:value="${gqcl.goodsQnaCategory}"></option>
					</th:block>
	          	</select>
	          </div>
	          <div class="form-group" style="margin-left:10px;">
	          	<span style="margin-right:37px; vertical-align:top;">내용</span>
	          		<textarea class="qnaInContent" id="goodsQnaContent" name="goodsQnaContent"></textarea>
	          	<div style="margin: -1px 0px -33px 68px;">
	          		<input type="hidden" class="hiddenCheck" id="secretCheck" name="secretCheck" value="N">
	          	<input type="checkbox" class="secretYN">
	          	<span style="display:inline-block; margin-left:5px; margin-right:5px;">비밀글로 문의하기</span>
	          	<input type="password" class="qnaPw" id="goodsQnaPw" name="goodsQnaPw" disabled>
	          	</div>
	          </div>
	      </div>
	      <div class="modal-footer" style="display:flex; justify-content:center;">
	      		<input type="hidden" class="qnaTitle" id="goodsQnaTitle" name="goodsQnaTitle">
	      		<input type="hidden" th:value="${goodsInfo.goodsCode}" id="goodsCode" name="goodsCode">
		        <button type="button" class="qnaClose" id="closeBtn" data-dismiss="modal">취소</button>
		        <button type="submit" class="qnaSubmit" id="qnaAdd">등록</button>
	      </div>
	    </div>
	  </div>
	</div>
</form>
	
<br><br><br>
<!-- 후기 등록 모달 -->
	<div th:include="user/review/review :: reviewModal"></div>		
<!-- 후기 신고 모달 -->
	<div th:include="user/review/userReport :: userReportModal"></div>		
<!-- 후기 댓글 모달 -->
	<div th:include="user/review/reviewComment :: reviewCommentModal"></div>				
</th:block>

<th:block layout:fragment="customJsScript">
<th:block th:replace="fragments/userJs :: datatablesFragment"></th:block>
<script th:inline="javascript">
$(function() {
	/* 스크롤 방지 코드 */
	$(".cartBtn").click(function(e) {
		e.preventDefault();
	});
	$(".buyBtn").click(function(e) {
		e.preventDefault();
	});
	
	/* --------------------- 상품 상세 페이지 이벤트 --------------------- */
	
	//상품 가격
	var goodsPrice = $('.goodsPrice').val();
		//상품 할인율
	var goodsDiscountRate = $('.goodsDiscountRate').val();
		//상품 할인가
	var discounted = goodsPrice * goodsDiscountRate / 100;
		//상품 정가-할인가 = 할인가격
	var salePrice = goodsPrice - discounted;
		//할인가격 * 선택 수량
	var totalPrice = salePrice * countVal
	
	/* 수량 증가 감소 */
	var goodsStock = $('.goodsStock').val(); //실제 상품 재고량 가져오기
	var strNum = $('.countVal').val(); //val에 들어있는 값은 아직 문자
	var countVal = parseInt(strNum, 10); //문자를 숫자로 
	// 감소버튼
	$('.minusBtn').click(function(e){
		e.preventDefault();
		countVal--;
		
		if(countVal <= 0){
			alert('최소 수량입니다');
			countVal = 1;
		}
		$('.countVal').val(countVal);
		console.log('minus 버튼: '+countVal);
		
		//수량 변경값에 따라 총 금액 변화주기
		$('.hiddenPrice').val(salePrice * countVal);
		var hiddenPrice = $('.hiddenPrice').val().replace(/(\d)(?=(?:\d{3})+(?!\d))/g,'$1,');
		$('.totalPrice').text(hiddenPrice);
		console.log(hiddenPrice);
	});
	// 증가 버튼
	$('.plusBtn').click(function(e){
		e.preventDefault();
		countVal++;
		
		if(countVal > goodsStock){
			alert('최대 수량입니다');
			countVal = 1;
		}
		$('.countVal').val(countVal);
		console.log('plus 버튼: '+countVal);
		
		//수량 변경값에 따라 총 금액 변화주기
		$('.hiddenPrice').val(salePrice * countVal);
		var hiddenPrice = $('.hiddenPrice').val().replace(/(\d)(?=(?:\d{3})+(?!\d))/g,'$1,');
		$('.totalPrice').text(hiddenPrice);
		console.log(hiddenPrice);
	});

	/* 이미지 슬라이드 */
	// 이미지 현재의 위치
	var imgOn = $('.imgBox').find(".on").index();
	// 이미지 총 개수 
	var imgLenght = $('.imgBox .img').length;
	
	// 왼쪽 버튼 눌렀을 때
	$('.imgLeftBtn').click(function(e) {
	    e.preventDefault();
	    console.log('이미지 현재 순서: '+imgOn)
	    console.log('이미지 총 개수: '+imgLenght)
	    
	    // imgBox안의 img 중 imgOn 번째의 on 클래스 삭제 
	    $('.imgBox .img').eq(imgOn).removeClass('on');
	    // imgBox안의 img 중 imgOn 번째 숨기기 
	    $('.imgBox .img').eq(imgOn).css('opacity', 0);
	    
	    // 이전 위치로 가기 위해
	    imgOn = imgOn -1;
	    if( imgOn < 0 ){
	      // 현재 위치 0일 때 돌아갈 경우(-1), 총 이미지의 마지막으로 이동
	      $('.imgBox .img').eq(imgLenght -1).css('opacity', 1);
	      $('.imgBox .img').eq(imgLenght -1).addClass('on');
	    }else{
	      // 돌아갈 위치가 -1이 아닌 경우, 그 전 이미지로 이동
	      $('.imgBox .img').eq(imgOn).css('opacity', 1);
	      $('.imgBox .img').eq(imgOn).addClass('on');
	    }
	});
	// 오른쪽 버튼 눌렀을 경우
	$('.imgRightBtn').click(function(e) {
	    e.preventDefault();
	    console.log('이미지 현재 순서: '+imgOn)
	    console.log('이미지 총 개수: '+imgLenght)
	    
	    $('.imgBox .img').eq(imgOn).removeClass('on');
	    $('.imgBox .img').eq(imgOn).css('opacity', 0);
	    
	    // 다음 위치로 가기 위해
	    imgOn = imgOn + 1;
	    if( imgOn === imgLenght ){
	      // 다음 위치가 총 개수보다 클 경우 처음 위치로 이동
	      $('.imgBox .img').eq(0).css('opacity', 1);
	      $('.imgBox .img').eq(0).addClass('on');
	    }else{
	      // 다음 위치가 있는 경우 
	      $('.imgBox .img').eq(imgOn).css('opacity', 1);
	      $('.imgBox .img').eq(imgOn).addClass('on');
	    }
	});
	
	/* 상품정보&후기&문의 탭 이벤트 */
    $('ul.tabList li').click(function(){
        var tabId = $(this).attr('data-tab');
 
        $('ul.tabList li').removeClass('current');
        $('.tabContent').removeClass('current');
 
        $(this).addClass('current');
        $("#"+tabId).addClass('current');
    })
	
    /* --------------------- 장바구니 추가--------------------- */
    
	$('.cartAddBtn').on('click', function(){
		console.log('장바구니 추가');
		var cartAmount = $(".countVal").val();
		var goodsCode = $(this).next(".goodsCode").val();
		$.ajax({
			url: '/user/goods/cartAdd',
			type: 'post',
			data: { cartAmount : cartAmount,
					goodsCode : goodsCode}
		})
			.done(function(result){
				if(result == 1){
					alert("장바구니에 추가되었습니다.");
				} else if(result == 2){
					alert("장바구니에 이미 담긴 상품입니다. 수량이 추가됩니다.");
				} else if(result == 3){
					alert("로그인이 필요합니다.");	
				}
			});
	});
    /* --------------------- 찜 추가--------------------- */
    
	$('.wishAddBtn').on('click', function(){
		console.log('찜 추가');
		var goodsCode = $(this).prev(".goodsCode").val();
		console.log(goodsCode);
		$.ajax({
			url: '/user/wishAdd',
			type: 'post',
			data: { goodsCode : goodsCode}
		})
			.done(function(result){
				if(result == 1){
					alert("찜 목록에 추가되었습니다.");
				}else if(result ==2){
					alert("이미 찜한 상품입니다.");
				}
			});
	});
    
	/* --------------------- 상품 문의 이벤트 --------------------- */
    /* 모달 열릴 때 이벤트 */
	$('.qnaModal').on('show.bs.modal', function(e) {
		console.log('modal open');
	}); 
	/* 모달 닫을 때 안에 있는 데이터 초기화 */
	$('.qnaModal').on('hidden.bs.modal', function(e) {
		console.log('modal close');
		document.forms['qnaModalForm'].reset();
	});
	
	/* 비밀글 checkbox 선택 시 입력 인풋 활성화 */
    $('.secretYN').click(function(){
        var secretCheck = $(this).prop('checked'); 
        // this를 사용하여 클릭한 checkbox 가 체크되도록 설정
        if(secretCheck){
            $('.qnaPw').attr('disabled', false);
            $('.qnaPw').focus();
            $('.hiddenCheck').val( 'Y' );
        }
        else{
            $('.qnaPw').attr('disabled', true);
            $('.qnaPw').val(null);
            $('.hiddenCheck').val( 'N' );
        }
    });
	
    /* 문의 제목 자동으로 넣기 */
    $("select[name=goodsQnaCategory]").change(function(){
    	  console.log($(this).val()); //value값 가져오기
    	  //text값 가져오기
    	  var qnaCateName = $("select[name=goodsQnaCategory] option:selected").text();
    	  console.log(qnaCateName);
    	  
    	  $('.qnaTitle').val( qnaCateName +' 문의합니다.' );
    }); 
    
    /* 유형 선택, 내용 입력 안했을 시 선택하라는 메세지 뜨게하기 */
    $('.qnaSubmit').click(function(){
    	var qnaCateName = $("select[name=goodsQnaCategory] option:selected").val();
    	if ( qnaCateName == 'none' ) {
    		alert('유형을 선택해주세요');
    		return false;
    	};
        var qnaInContent = $.trim($('.qnaInContent').val());
        if (qnaInContent == '') {
          alert('내용을 입력해주세요');
          $('.qnaInContent').focus();
          return false;
        }
    });

    /* 문의 등록시 문의 화면으로 새로고침 */
    if(/*[[${param.qnaView}]]*/ !== null) {
		document.querySelector('#qnaTab').click();
		console.log('zzzzzzzz');
	}
    
    /* 답변완료 시 녹색으로, 답변대기 시 회색 */
	$(".answerYN").each(function(){
		var answerYN = $('.answerYN').text();
		console.log(answerYN);
		
		if($(this).text() == '[답변완료]'){
			$(this).css('color','#98b856');
		}
		else{
			$(this).css('color','#9a9a9a');
		}
	});
    
	/* 비밀글일 때 qna제목 옆 자물쇠 아이콘 넣기 */
	$('.qnaToggle').each(function(){
		//var icon = document.createElement("i");
		
		var secretVal = $(this).parent().data('secret');
		console.log(secretVal);
		
		if(secretVal == 'Y'){
			$(this).append('<i class="fi fi-rr-lock" style="font-size:14px; color:gray;"></i>');		
		}
	});

	/* 문의 클릭 시 답변 펼치기 */
	$(".qnaToggle").click(function (){
		$(".qnaToggle").each(function(){
			$(this).parent().next().css('display', 'none');
		})
			$(this).parent().next().toggle();
		/* $.ajax({ type: "POST",
	                url: "/user/goods/answerView",
	           	    data: var a = { 'goodsCode' : goodsCode,
	           			   		    'qnaCode' : qnaCode },
	                success: function (data) {
	                if(result == 1){  */
					//1
					
	                //0
	             //}else {
	             //},
			//});
	});
	
	
    
});



	/* --------------------- 상품 후기 이벤트 시작 (초희)--------------------- */
	$(function(){
		var userId = $('#userId').val();
		console.log(userId);
		
		// 추천버튼 클릭시(추천 추가 또는 추천 제거)
		$(".reviewLikeBtn").click(function(){
			let hart = $(this);
			let reviewList = hart.val();
			let spanRecom = hart.next();
			console.log(spanRecom);
			
			if(hart.hasClass('off')){
				$.ajax({
					url: "/user/review/reviewLike",
	                type: "GET",
	                data: {
	                	'reviewList': reviewList,
	                	'userId': userId
	                },	
	                dataType: "text",
	                success: function (likeAmount) {
	                	alert("추천하였습니다.")
	                	$(spanRecom).text('추천수 ' + likeAmount);
	                	hart.removeClass("off").addClass("on")
	                }
				});
			}else if(hart.hasClass('on')){
				$.ajax({
					url: "/user/review/reviewLikeDelete",
	                type: "GET",
	                data: {
	                	'reviewList': reviewList,
	                	'userId': userId
	                },
	                dataType: "text",
	                success: function (likeAmount) {
	                	alert("추천을 해제 하였습니다.")
	                	$(spanRecom).text('추천수 ' + likeAmount);
	                	hart.removeClass("on").addClass("off")
	                	
	                }
				});
			}
		});
	});
	
	
	/* --------------------- 상품 후기 이벤트 끝 (초희)--------------------- */
	/* 초희 - 모달로 값 보내기*/
	// 신고 부분
	   $('.userReportModal').click(function(){
	      let review = $(this).data("review-list");
	      console.log("test 중 " + review);
	
	      let buyerId = $(this).data("buyer-id");
	      $('#reportedId').val( buyerId );
	      console.log(buyerId);
	      /* var goodsCode =  $(this).data("goods-code");
	      $('#goodsCodeeee').val( goodsCode );
	      console.log(goodsCode); */
	
	      $('#reportWhat').val( review );
	      console.log(review);
	   });
	// 댓글 부분
	   $('.reviweCommentCode').click(function(){
	
	      let reviewList = $(this).data("review-code");
	      console.log("review 댓글 " + reviewList)
	
			let recomModel = $('#recomModel');
	           $.ajax({
	              url: "/user/review/reviewCommentList",
	              method: "GET",
	              data: { 'reviewList' : reviewList },
	              dataType: "json",
	          	  success: function (data) {
	                 console.log(data);	
	                 let recomModel = "";
	        	  	$.each(data, function(index, item){
						let reviewCommentContent = data[index].review_comment_content; 	 
						console.log(reviewCommentContent);
	        	  		recomModel += "<p>" + data[index].user_id + " ○ " + data[index].reg_date +  "</p>"
	        	  		recomModel += "<input type='text' style='width:99%; height: 50px;' readonly='readonly' value = '"+ reviewCommentContent +"'>" 
	        	  		recomModel += "<div class='row'> <hr align='center' style='border: solid 1px #EDEDED; width: 80%;'> </div>"
					})
					$('#recomModel').prepend(recomModel);
	        	  	// 모달 닫을때 값 초기화
	        	  	$('.reviweComment').on('hidden.bs.modal', function(e) {
						$('#recomModel').empty();
					})
              	
	        	}	
	
	      });
	   });
</script>
</th:block>
</html>