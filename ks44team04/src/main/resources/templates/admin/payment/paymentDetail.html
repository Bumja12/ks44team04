<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/adminDefault}">

<th:block layout:fragment="customCss">
<style>
th, td {
	text-align: center;
}

.table > tbody > tr > td {
	vertical-align: middle;
	
}
</style>
</th:block>

<th:block layout:fragment="customTitle">
	<title th:text="${title}"></title>
</th:block>

<th:block layout:fragment="customContents">
	<div class="col-md-12 col-sm-12 col-xs-12" style="overflow: scroll; width:100%; height:700px;">
		<div class="x_panel">
			<div class="x_title">
				<h2>
					결제상세내역<small>Admin</small>
					</h3>
					<ul class="nav navbar-right panel_toolbox">
						<li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
						</li>
						<li class="dropdown"><a href="#" class="dropdown-toggle"
							data-toggle="dropdown" role="button" aria-expanded="false"><i
								class="fa fa-wrench"></i></a>
							<ul class="dropdown-menu" role="menu">
								<li><a href="#">Settings 1</a></li>
								<li><a href="#">Settings 2</a></li>
							</ul></li>
						<li><a class="close-link"><i class="fa fa-close"></i></a></li>
					</ul>
					<div class="clearfix"></div>
			</div>
			<div class="x_content">
				<div th:replace="fragments/orderSearch :: orderSearchFragment"></div>
				<table id="datatable-responsive"
					class="table table-striped table-bordered dt-responsive nowrap"
					cellspacing="0" width="100%">
					<thead>
						<tr>
							<th>주문번호</th>
							<th style="width: 100px">회원아이디</th>
							<th>주문상세번호</th>
							<th>상품정보</th>
							<th style="width: 80px">결제수단</th>
							<th style="width: 80px">영업사</th>
							<th>카드번호/환불계좌</th>
							<th>결제금액</th>
							<th>승인일시/입금일시</th>
							<th>관리</th>
						</tr>
					</thead>
					<tbody>
						<th:block th:if="${not #lists.isEmpty(paymentDetailList)}" th:each="p : ${paymentDetailList}">
							<th:block th:if="${not #lists.isEmpty(p.paymentTotal)}" th:each="pt, status : ${p.paymentTotal}">
								<tr>
									<th:block th:if="${status.index == 0}">				
										<td th:rowspan="${status.size}" th:text="${p.orderNum}"></td>
										<td th:rowspan="${status.size}" th:text="${p.buyerId}"></td>
									</th:block>	
									<td th:text="${pt.orderDetailCode}"></td>
									<td th:text="${pt.goodsName}"></td>
									<td th:text="${pt.paymentMethod}"></td>
									<td th:text="${pt.cardCompany}"></td>
									<td th:text="${pt.cardNumber}"></td>
									<td th:text="${'₩' + #numbers.formatInteger(pt.orderPrice, 3, 'COMMA')}"></td>
									<th:block th:if="${status.index == 0}">
										<td th:rowspan="${status.size}" th:text="${'₩' + #numbers.formatInteger(pt.approvePrice, 3, 'COMMA')}"></td>
										<td th:rowspan="${status.size}" th:text="${p.approveDate}"></td>
									</th:block>
									<td>
										<a th:href="@{/admin/payment/modifyPaymentDetail(orderDetailCode=${pt.orderDetailCode})}"><i class="fa fa-edit"></i> 수정</a> 
										<a th:href="@{|/admin/payment/remove/${pt.orderDetailCode}|}"><i class="fa fa-close"></i>삭제</a>
									</td>
								</tr>
							</th:block>
						</th:block>
						<tr th:unless="${not #lists.isEmpty(paymentDetailList)}">
							<td colspan="10">등록된 상품이 없습니다.</td>
						</tr>
					</tbody>
				</table>

			</div>
		</div>
	</div>
</th:block>

<th:block layout:fragment="customJsScript">
	<th:block th:replace="/fragments/adminJs :: datatablesFragment"></th:block>
</th:block>

</html>