<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ks44team04.admin.mapper.UserMapper">

    <resultMap type="User" id="userResultMap">
        <result column="user_id" property="userId"/>
        <result column="user_pw" property="userPw"/>
        <result column="user_name" property="userName"/>
        <result column="user_gender" property="userGender"/>
        <result column="user_nickname" property="userNickname"/>
        <result column="user_address" property="userAddress"/>
        <result column="user_phone" property="userPhone"/>
        <result column="user_email" property="userEmail"/>
        <result column="user_right" property="userRight"/>
        <result column="user_reg_date" property="userRegDate"/>
        <result column="user_update_date" property="userUpdateDate"/>
        <result column="user_status" property="userStatus"/>
        <result column="user_penalty" property="userPenalty"/>
        <result column="user_point" property="userPoint"/>
        <result column="user_info_keep" property="userInfoKeep"/>
        <result column="user_level" property="userLevel"/>
    </resultMap>
    
    <!-- 회원 가입 -->
	<insert id="addUser" parameterType="User">
		/* 회원 가입 */
		INSERT INTO tb_user
			(user_id, user_pw, user_name, user_gender, user_nickname, user_address, user_phone, user_email, user_right, user_reg_date, user_update_date, user_status, user_penalty, user_point, user_info_keep, user_level)
		VALUES 
			('#{userId}', '#{userPw}', '#{userName}', '#{userGender}', '#{userNickname}', '#{userAddress}', '#{userPhone}', '#{userEmail}', '#{userRight}', CURDATE(), CURDATE(), '#{userStatus}', #{userPenalty}, #{userPoint}, '#{userInfoKeep}', '#{userLevel}')
	</insert>
	
	
	<!-- 회원 권한 조회 -->
	<select id="getLevelList" resultType="Level">
		/* 회원 권한 조회 */
		SELECT
			 l.user_level		AS userRightGruop
			,l.level_status		AS rightStatus
		FROM 
			tb_level AS l
	</select>
    
    <!-- 회원 목록 조회 -->
    <select id="getUserList" resultMap="userResultMap">
    	/* 회원 목록 조회 */
    	SELECT
			 u.user_id
			,u.user_pw
			,u.user_name
			,u.user_gender
			,u.user_nickname
			,u.user_address
			,u.user_phone
			,u.user_email
			,u.user_right
			,l.level_status
			,u.user_reg_date
			,u.user_update_date
			,u.user_status
			,u.user_penalty
			,u.user_point
			,u.user_info_keep
			,u.user_level
		FROM 
			tb_user AS u
			INNER JOIN 
			tb_level AS l
			ON 
			u.user_right = l.user_level;
    </select>

    <select id="userLogin" parameterType="String" resultType="String">
        SELECT IF(COUNT(*) = 1, user_pw, 'none')
        FROM tb_user
        WHERE user_id = #{userId};
    </select>

    <select id="getLoginUserInfo" parameterType="String" resultMap="userResultMap">
        SELECT user_name,
               user_right
        FROM tb_user
        WHERE user_id = #{userId};
    </select>
    
</mapper>